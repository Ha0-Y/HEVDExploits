#pragma once

#include "utils.hpp"

#define SPRAY_NUM           5000

#define IOCTL_NonPagedPool_ALLOC         0x222013
#define IOCTL_NonPagedPool_USE           0x222017
#define IOCTL_NonPagedPool_FREE          0x22201B
#define IOCTL_NonPagedPool_ALLOC_FAKE    0x22201F



typedef struct _USE_AFTER_FREE_NON_PAGED_POOL 
{
    VOID *Callback;
    CHAR Buffer[0x54];
} USE_AFTER_FREE_NON_PAGED_POOL, * PUSE_AFTER_FREE_NON_PAGED_POOL;



VOID NonPagedPoolUafExploit();