#pragma once

#include "utils.hpp"

#define SPRAY_NUM                   5000

#define IOCTL_NonPagedPoolNx_ALLOC         0x222053
#define IOCTL_NonPagedPoolNx_USE           0x222057
#define IOCTL_NonPagedPoolNx_FREE          0x22205B
#define IOCTL_NonPagedPoolNx_ALLOC_FAKE    0x22205F



typedef struct _USE_AFTER_FREE_NON_PAGED_POOLNX
{
    VOID* Callback;
    CHAR Buffer[0x54];
} USE_AFTER_FREE_NON_PAGED_POOLNX, * PUSE_AFTER_FREE_NON_PAGED_POOLNX;



VOID NonPagedPoolUafNxExploit();